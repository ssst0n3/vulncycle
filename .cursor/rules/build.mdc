---
alwaysApply: true
---

# 构建验证规则 (Build Verification Rule)

## 核心要求

**每次修改代码后，必须确保 `docker compose up -d --build` 能够正常执行。**

## 执行流程

1. **修改代码后**：在完成任何代码修改（包括但不限于源代码、配置文件、依赖项等）后，必须执行构建验证。

2. **构建验证**：
   - 运行 `docker compose up -d --build` 命令
   - 确保构建过程**完全成功**，无任何错误或警告
   - 如果构建失败，必须修复问题后再继续

3. **验证时机**：
   - 在提交代码之前
   - 在向用户确认更改完成之前
   - 如果修改涉及构建相关的文件（如 `package.json`、`Dockerfile`、`vite.config.ts` 等），必须立即验证

## 特殊情况

- **仅文档修改**：如果只修改了文档文件（如 `.md` 文件），可以跳过构建验证
- **仅注释修改**：如果只修改了代码注释，可以跳过构建验证
- **构建配置修改**：如果修改了构建相关的配置文件，**必须**执行构建验证

## 错误处理

如果 `docker compose up -d --build` 失败：
1. 分析错误原因
2. 修复相关问题
3. 重新执行 `docker compose up -d --build` 直到成功
4. 不要提交或确认无法构建的代码

---

**目标**：确保项目始终处于可构建状态，避免破坏构建流程的代码进入代码库。